<!DOCTYPE html>
<html lang="en">
    <head>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Web application lab3</title>
    </head>
    <body>
        <h1>Lightning game</h1>
        <hr>
        <button id="question5" onclick="question(5)">
            5
        </button>
        <button id="question10" onclick="question(10)">
            10
        </button>
        <button id="question15" onclick="question(15)">
            15
        </button>
        <div class="gameplay">
            <div id="question">
                
            </div><hr>
            <button id="choice1" onclick="submit(1)">

            </button>
            <button id="choice2" onclick="submit(2)">

            </button>
            <button id="choice3" onclick="submit(3)">

            </button>
        </div>
    </body>
    <script>
        let randomQuestionNumber = 0;
        let numberQuestion = 0;
        let score = 0;
        let questionArr = [];
        let choice1Arr = [];
        let choice2Arr = [];
        let choice3Arr = [];
        let answerArr = [];
        function question(params) {
            numberQuestion = params
            // while (numberQuestion > 0) {
                $.get('list.json', function(data) {
                    for (let i = 0 ; i < data.items.length ; i++) {
                        questionArr[i] = data.items[i].question
                        choice1Arr[i] = data.items[i].choice1
                        choice2Arr[i] = data.items[i].choice2
                        choice3Arr[i] = data.items[i].choice3
                        answerArr[i] = data.items[i].answer
                    }
                    gameplay()
                });
            // }
        }
        function gameplay() {
            randomQuestionNumber = getRandomInt(0, questionArr.length)
            $('#question').html(questionArr[randomQuestionNumber])
            $('#choice1').html(choice1Arr[randomQuestionNumber])
            $('#choice2').html(choice2Arr[randomQuestionNumber])
            $('#choice3').html(choice3Arr[randomQuestionNumber])
            questionArr.splice(randomQuestionNumber, 1)
        }
        function submit(choice) {
            
            if (choice == 1) {
                if ($('#choice1').text() == answerArr[randomQuestionNumber]) {
                    score++
                    numberQuestion--
                    spliceArray()
                    gameplay()
                } else {
                    numberQuestion--
                    spliceArray()
                    gameplay()
                }
            }
            else if (choice == 2) {
                if ($('#choice2').text() == answerArr[randomQuestionNumber]) {
                    score++
                    numberQuestion--
                    spliceArray()
                    gameplay()
                } else {
                    numberQuestion--
                    spliceArray()
                    gameplay()
                }
            }
            else if (choice == 3) {
                if ($('#choice3').text() == answerArr[randomQuestionNumber]) {
                    score++
                    numberQuestion--
                    spliceArray()
                    gameplay()
                } else {
                    numberQuestion--
                    spliceArray()
                    gameplay()
                }
            }
            if (numberQuestion == 0) {
                gameover()
            }
        }
        function spliceArray() {
            choice1Arr.splice(randomQuestionNumber, 1)
            choice2Arr.splice(randomQuestionNumber, 1)
            choice3Arr.splice(randomQuestionNumber, 1)
            answerArr.splice(randomQuestionNumber, 1)
        }
        function getRandomInt(min, max) {
            min = Math.ceil(min)
            max = Math.floor(max)
            return Math.floor(Math.random() * (max - min)) + min
        }
        function gameover() {
            alert(score)
        }
    </script>
    <style>
        button {
            width: 150px;
            height: 100px;
            font-size: 30px;
        }
    </style>
</html>